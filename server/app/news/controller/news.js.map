{
    "version": 3,
    "sources": [
        "../../../src/news/controller/news.js"
    ],
    "names": [
        "fetchAction",
        "setCorsHeader",
        "where",
        "get",
        "model",
        "fetchNews",
        "news",
        "__this",
        "promise",
        "forEach",
        "item",
        "index",
        "push",
        "resolve",
        "reject",
        "id",
        "cate_id",
        "select",
        "author_id",
        "all",
        "results",
        "map",
        "author",
        "success",
        "removeAction",
        "delete",
        "affectedRows",
        "header",
        "think",
        "controller",
        "base"
    ],
    "mappings": "AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mBAEQA,W;;;;;;;;AACL,mBAAKC,aAAL;AACKC,mB,GAAQ,KAAKC,GAAL,E;;qBACI,KAAKC,KAAL,SAAmBC,SAAnB,CAA6BH,KAA7B,C;;;AAAbI,kB;AACCC,oB,GAAS,I;AACTC,qB,GAAU,E;;AACdF,mBAAKG,OAAL,CAAa,UAACC,IAAD,EAAMC,KAAN,EAAc;AACzBH,wBAAQI,IAAR,CAAa,sBAAY,UAACC,OAAD,EAASC,MAAT,EAAkB;AACzCP,yBAAOH,KAAP,SAAqBF,KAArB,CAA2B,EAACa,IAAGL,KAAKM,OAAT,EAA3B,EAA8CC,MAA9C;AACAJ,0BAAQN,OAAOH,KAAP,SAAqBF,KAArB,CAA2B,EAACa,IAAGL,KAAKQ,SAAT,EAA3B,EAAgDD,MAAhD,EAAR;AACD,iBAHY,CAAb;AAID,eALD;;qBAMoB,kBAAQE,GAAR,CAAYX,OAAZ,C;;;AAAhBY,qB;;AACJd,mBAAKe,GAAL,CAAS,UAACX,IAAD,EAAMC,KAAN,EAAc;AACrB,oBAAIW,SAAS,QAAb;AACA,uBAAOZ,KAAKY,MAAL,IAAeF,QAAQT,KAAR,EAAe,CAAf,CAAtB;AACD,eAHD;+CAIM,KAAKY,OAAL,CAAajB,IAAb,C;;;;;;;;;;;;;;;;;mBAEFkB,Y;;;;;;;AACJ,mBAAKvB,aAAL;AACIG,mB,GAAQ,KAAKA,KAAL,Q;AACRW,gB,GAAK,KAAKZ,GAAL,M;;qBACgBC,MAAMF,KAAN,CAAY,EAACa,IAAGA,EAAJ,EAAZ,EAAqBU,MAArB,E;;;AAArBC,0B;gDACG,KAAKH,OAAL,CAAaG,YAAb,C;;;;;;;;;;;;;;;;;mBAETzB,a,4BAAe;AACb,SAAK0B,MAAL,CAAY,6BAAZ,EAA2C,KAAKA,MAAL,CAAY,QAAZ,KAAyB,GAApE;AACA,SAAKA,MAAL,CAAY,8BAAZ,EAA4C,+BAA5C;AACA,SAAKA,MAAL,CAAY,8BAAZ,EAA4C,6BAA5C;AACA,SAAKA,MAAL,CAAY,kCAAZ,EAAgD,MAAhD;AACD,G;;;EAhC0BC,MAAMC,UAAN,CAAiBC,I",
    "file": "../../../src/news/controller/news.js",
    "sourcesContent": [
        "'use strict';\nexport default class extends think.controller.base {\n  async fetchAction(){\n  \tthis.setCorsHeader();\n    let where = this.get()\n  \tlet news = await this.model(`news`).fetchNews(where);\n    let __this = this;\n    let promise = [];\n    news.forEach((item,index)=>{\n      promise.push(new Promise((resolve,reject)=>{\n        __this.model(`cate`).where({id:item.cate_id}).select();\n        resolve(__this.model(`user`).where({id:item.author_id}).select())\n      }))\n    });\n    let results = await Promise.all(promise);\n    news.map((item,index)=>{\n      let author = 'author';\n      return item[author] = results[index][0]\n    })\n  \treturn this.success(news);\n  }\n  async removeAction(){\n    this.setCorsHeader();\n    let model = this.model(`news`);\n    let id = this.get(`id`);\n    let affectedRows = await model.where({id:id}).delete()\n    return this.success(affectedRows);\n  }\n  setCorsHeader(){\n    this.header(\"Access-Control-Allow-Origin\", this.header(\"origin\") || \"*\");\n    this.header(\"Access-Control-Allow-Headers\", \"x-requested-with,Content-Type\");\n    this.header(\"Access-Control-Allow-Methods\", \"GET,POST,OPTIONS,PUT,DELETE\");\n    this.header(\"Access-Control-Allow-Credentials\", \"true\");\n  }\n}"
    ]
}