{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/userbak.js"
    ],
    "names": [
        "fs",
        "require",
        "path",
        "moment",
        "indexAction",
        "header",
        "model",
        "select",
        "data",
        "success",
        "fetchuserAction",
        "where",
        "get",
        "json",
        "loginAction",
        "post",
        "think",
        "isEmpty",
        "fail",
        "errorno",
        "addAction",
        "method",
        "http",
        "toLowerCase",
        "end",
        "params",
        "id",
        "file",
        "user",
        "now",
        "Date",
        "format",
        "update",
        "createTime",
        "affectedRows",
        "add",
        "controller",
        "base"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/userbak.js",
    "sourcesContent": [
        "'use strict';\n\nimport Base from '../../common/base/base.js';\nvar fs = require('fs');\nvar path = require('path');\nlet moment = require('moment')\n\nexport default class extends think.controller.base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async indexAction() {\n    this.header('Access-Control-Allow-Origin', this.header('origin') || '*');\n    this.header('Access-Control-Allow-Headers', 'x-requested-wit,Content-Type');\n    this.header('Access-Control-Request-Method', 'GET,POST,PUT,DELETE');\n    this.header('Access-Control-Allow-Credentials', 'true');\n    let data = await this.model(`user`).select();\n    return this.success(data)\n  }\n  async fetchuserAction(){\n    this.header('Access-Control-Allow-Origin', this.header('origin') || '*');\n    this.header('Access-Control-Allow-Headers', 'x-requested-wit,Content-Type');\n    this.header('Access-Control-Request-Method', 'GET,POST,PUT,DELETE');\n    this.header('Access-Control-Allow-Credentials', 'true');\n    let where = this.get();\n    let data =await this.model(`user`).where(where).select();\n\n    return this.json({data:data})\n  }\n\tasync loginAction() {  \n      let where = this.post();      \n\t\t  let data =await this.model(`user`).where(where).select();\n      if(think.isEmpty(data)){\n        return this.fail({errorno:-1},\"用户名或密码错误\")  \n      }\n      else{\n        return this.success(data)\n      }\n\t}\n  async addAction(){\n    let method = this.http.method.toLowerCase();\n    if(method === 'options'){\n      this.header('Access-Control-Allow-Origin', this.header('origin') || '*');\n      this.header('Access-Control-Allow-Headers', 'x-requested-wit,Content-Type');\n      this.header('Access-Control-Request-Method', 'GET,POST,PUT,DELETE');\n      this.header('Access-Control-Allow-Credentials', 'true');\n      this.end();\n    }\n    else{  \n      let model = this.model(`user`);\n      let params = this.post();\n      let id = this.post(`id`);\n      let file = JSON.stringify(this.post(`file`));\n      let user = this.model(`user`);\n      let now =  moment(new Date()).format(\"YYYY-MM-DD HH:mm:ss\");\n      this.header('Access-Control-Allow-Origin', this.header('origin') || '*');\n      this.header('Access-Control-Allow-Headers', 'x-requested-wit,Content-Type');\n      this.header('Access-Control-Request-Method', 'GET,POST,PUT,DELETE');\n      this.header('Access-Control-Allow-Credentials', 'true');\n      \n      if(!think.isEmpty(id)){\n        let affectedRows = await user.where({id:id}).update(Object.assign(params,{file:file},{createTime:now}));\n        return this.success(affectedRows);\n      }\n      else{\n        let affectedRows = await user.add(Object.assign(params,{file:file},{createTime:now}));\n      }\n\n    }\n  }\n\n  //   let model = this.model(`user`);\n  //   let params = this.post();\n  //   let id = this.post(`id`);\n  //   let file = JSON.stringify(this.post(`file`));\n  //   let user = this.model(`user`);\n  //   let now =  moment(new Date()).format(\"YYYY-MM-DD HH:mm:ss\");\n  //   // 更新用户\n  //   if(!think.isEmpty(id)){\n  //       let affectedRows = await user.where({id:id}).update(Object.assign(params,{file:file},{createTime:now}));\n  //       return this.success(affectedRows);\n  //   }\n  //   //新增用户\n  //   else{\n  //     let method = this.http.method.toLowerCase();\n  //     if(method === 'options'){\n  //       this.header('Access-Control-Allow-Origin', this.header('origin') || '*');\n  //       this.header('Access-Control-Allow-Headers', 'x-requested-wit,Content-Type');\n  //       this.header('Access-Control-Request-Method', 'GET,POST,PUT,DELETE');\n  //       this.header('Access-Control-Allow-Credentials', 'true');\n  //       return;\n  //     }\n  //     let affectedRows = await user.add(Object.assign(params,{file:file},{createTime:now}));\n  //   }\n  // }\n}\n  "
    ]
}